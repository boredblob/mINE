[Rainmeter]
Update=500
OnRefreshAction=[!FadeDuration 200]

[Metadata]
Name=Track info
Author=Me
Information=Displays track title and artist
Version=
License=Creative Commons Attribution - Non - Commercial - Share Alike 3.0

[Variables]
@include=#@#variables.ini

[MeasureWindowsColor]
Measure=Plugin
Plugin=SysColor
Hex=0
DisplayType=RGB
ColorType=DWM_COLOR 
OnChangeAction=[!UpdateMeasure "MeasureWindowsColorR"][!UpdateMeasure "MeasureWindowsColorG"][!UpdateMeasure "MeasureWindowsColorB"][!UpdateMeasure "SetColour"]

[MeasureWindowsColorR]
Measure=Plugin
Plugin=SysColor
DisplayType=Red
ColorType=DWM_COLOR

[MeasureWindowsColorG]
Measure=Plugin
Plugin=SysColor
DisplayType=Green
ColorType=DWM_COLOR 

[MeasureWindowsColorB]
Measure=Plugin
Plugin=SysColor
DisplayType=Blue
ColorType=DWM_COLOR

[SetColour]
measure=Calc
IfConditionMode=1
IfCondition= (1 = 1)
IfTrueAction=[!SetVariable background "([MeasureWindowsColorR]/2),([MeasureWindowsColorG]/2),([MeasureWindowsColorB]/2)"][!UpdateMeter "Background"][!Update][!Redraw]
UpdateDivider=-1
DynamicVariables=1

[Background]
meter = shape
x = ((1920 - #cornerW#) - #backgroundW#)
y = 0
w = #backgroundW#
h = #middleY#
shape = Path backgroundPath | fill color #background#,50 | strokeWidth 0 | stroke color #background#,50
backgroundPath = 0,0 | LineTo #backgroundW#,0 | LineTo #backgroundW#,#middleY# | LineTo 50,#middleY# | LineTo 0,0 | ClosePath 1
antiAlias = 1
hidden = 0
padding = 0,0,0,0
DynamicVariables=1

[PlayerMeasure]
measure = nowplaying
playername = Spotify
playertype = state
OnChangeAction=[!UpdateMeasure isPlaying]

[isPlaying]
measure = calc
formula=PlayerMeasure
ifAboveValue = 1
ifAboveAction = [!HideFade][!Redraw]
ifBelowValue = 1
ifBelowAction = [!HideFade][!Redraw]
ifEqualValue = 1
ifEqualAction = [!ShowFade][!UpdateMeter InfoMeter][!Redraw]

[TitleMeasure]
measure = nowplaying
playername = [PlayerMeasure]
playertype=title
OnChangeAction=[!UpdateMeter InfoMeter][!Redraw]

[ArtistMeasure]
measure = nowplaying
playername = [PlayerMeasure]
playertype=artist
OnChangeAction=[!UpdateMeter InfoMeter][!Redraw]

[TextStyle]
antiAlias = 1
fontWeight = 300
fontColor = 255,255,255,150
fontFace = "Raleway"
fontSize = 16
clipString = 0
stringAlign = Center

[InfoMeter]
meter = string
meterStyle = TextStyle
x = ((#textWidth# / 2) + #centreX#)
y = 4
w = #textWidth#
measureName = TitleMeasure
measureName2 = ArtistMeasure
text = %1 - %2